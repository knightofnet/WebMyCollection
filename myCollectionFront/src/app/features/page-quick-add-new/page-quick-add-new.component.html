<div class="panels form-container overflow-hidden">
  <!-- Zone 1 : Photos -->

  @if (currentZone() === 0) {
    <div class="panel vh-100 d-flex flex-column justify-content-center align-items-center" id="zone-photos">
      <h2>1. Photos</h2>

      <app-photo-payload (photoSelected)="onPhotoSelected($event)"></app-photo-payload>

    </div>
  } @else if (currentZone() === 1) {
    <div class="panel vh-100 d-flex flex-column justify-content-center align-items-center" id="zone-preview-photos">
      <h2>Aperçu de la photo</h2>
      <!-- Contenu à remplir plus tard -->

      @if (photoSelected()) {
        <img class="preview" [src]="photoSelected()" alt="Prévisualisation">
      } @else {

        <div class="alert alert-info">
          Aucune photo sélectionnée.
        </div>
      }


    </div>
  } @else if (currentZone() === 2) {
    <!-- Zone 2 : Nom de l'objet -->
    <div class="panel vh-100 min-vh-100  flex-grow-1 d-flex flex-column justify-content-center align-items-center w-100"
         id="zone-nom"
         hidden>
      <h2>2. Nom de l'objet</h2>

      <div class="m-1 p-1">

        <input
          #inputName
          id="name" type="text"
          class="form-control"
          (keyup)="onInputNameKeyUp($event)"
          placeholder="ex. Batman #1"
          [matAutocomplete]="auto"
          required>

        <mat-autocomplete #auto="matAutocomplete">
          @for (street of filteredObjectNames | async; track street) {
            <mat-option [value]="street">{{ street }}</mat-option>
          }
        </mat-autocomplete>

      </div>

      <div>
        @for (obj of lastObjects; track $index) {
          <button class="btn btn-outline-primary" (click)="addToInputName(lastObjects[$index])">
            {{ obj }}
          </button>
        }
      </div>

    </div>
  } @else if (currentZone() === 3) {
    <!-- Zone 3 : Description, catégorie, mots-clés -->
    <div class="panel vh-100 min-vh-100  flex-grow-1 d-flex flex-column justify-content-center align-items-center w-100"
         id="zone-details"
         hidden>
      <div class="panel-content">
        <h2>3. Détails</h2>
        <!-- Contenu à remplir plus tard -->

        <div class="row g-3 mb-3">
          <div class="col-md-12">
            <label for="description" class="form-label">Description</label>
            <textarea #textAreaDescription
                      id="description" rows="3" class="form-control"
                      placeholder="Ajoutez quelques détails…"
            ></textarea>
          </div>
        </div>
        <div class="row g-3">

          <div class="col-md-6 mb-3">
            <label for="categories" class="form-label">Catégories</label>
            <ng-select
              [multiple]="true"
              [placeholder]="'Ajouter des catégories'"
              [items]="categories"
              bindValue="Id_Categorie"
              bindLabel="Nom"
              [ngModel]="newObject.categories"
              [compareWith]="compareCategories"
              [addTag]="true"
              (add)="addCategoryToSelect($event)"
              [closeOnSelect]="true"
            >

            </ng-select>

            <div class="mt-3">
              @for (lCategory of lastCategories; track lCategory.Id_Categorie) {
                <button class="btn btn-outline-primary" (click)="addCategoryToSelect(lCategory)">
                  {{ lCategory.Nom }}
                </button>
              }
            </div>

          </div>

          <div class="col-md-6">
            <label for="keywords" class="form-label">Mots-clés</label>
            <ng-select
              [multiple]="true"
              [placeholder]="'Ajouter des mots-clés'"

              [items]="keywords"
              bindValue="Id_Categorie"
              bindLabel="Nom"
              [ngModel]="newObject.keywords"
              [compareWith]="compareCategories"
              [addTag]="true"
              (add)="addNewKeywordToSelect($event)"
              [closeOnSelect]="true"


            >
            </ng-select>

          </div>

        </div>
      </div>
    </div>
  } @else if (currentZone() === 4) {
    <!-- Zone 4 : Résumé et confirmation -->
    <div class="panel vh-100 flex-grow-1 d-flex flex-column justify-content-center align-items-center" id="zone-final"
         hidden>
      <h2>4. Résumé et confirmation</h2>

      @if (photoSelected()) {
        <div class="text-center w-25 mb-2">
          <img class="img-thumbnail" [src]="photoSelected()" alt="Prévisualisation">
        </div>
      } @else {

        <div class="alert alert-info">
          Aucune photo sélectionnée.
        </div>
      }

      <p>Nom : {{ newObject.nom }}</p>
      @if (newObject.description) {
        <p>Description : {{ newObject.description }}</p>
      }
      <p>Catégories :
        @if (newObject.categories && newObject.categories!.length > 0) {
          @for (cat of newObject.categories; track cat.Id_Categorie) {
            <span class="badge bg-primary m-1">{{ cat.Nom }}</span>
          }
        } @else {
          Aucune catégorie
        }
      </p>

      <p>Mots-clés :
        @if (newObject.keywords && newObject.keywords!.length > 0) {
          @for (cat of newObject.keywords; track cat.Id_Categorie) {
            <span class="badge bg-primary m-1">{{ cat.Nom }}</span>
          }
        } @else {
          Aucun mot-clé
        }
      </p>


      <button class="btn btn-success" (click)="onSubmit()">Ajouter l'objet</button>
    </div>
  }


  <!-- Footer navigation -->
  <div class="form-footer position-fixed bottom-0 start-0 w-100 p-3 d-flex justify-content-between align-items-center"
       style="background: rgba(0,0,0,0.05);">
    <button class="btn btn-light" (click)="prevZone()" [disabled]="currentZone() === 0">Précédent</button>
    <button class="btn btn-dark" (click)="nextZone()" [disabled]="currentZone() === zones.length - 1">Suivant</button>
  </div>
</div>





